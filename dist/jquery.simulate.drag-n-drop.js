!function(e,t){"use strict";e.fn.simulate=function(t,a){switch(t){case"drag":case"drop":case"drag-n-drop":var r=this.first();return new e.simulate(r[0],t,a),r;default:return this.each((function(){new e.simulate(this,t,a)}))}};var a=Date.now||function(){return(new Date).getTime()},r=/\[object (?:HTML)?Document\]/;function n(t){return r.test(Object.prototype.toString.call(e(t)[0]))}function o(t,a){var r;if(e.isFunction(a)){for(r=0;r<t.length;r+=1)if(a(t[r]))return t[r];return null}for(r=0;r<t.length;r+=1)if(t[r])return t[r];return null}function i(t){var a,r=e(t);return{x:(a=n(r[0])?{left:0,top:0}:r.offset()).left+r.outerWidth()/2,y:a.top+r.outerHeight()/2}}function s(t,a,r){var o;return o=n(a)?e(a):e(r||document),"number"==typeof t&&"number"==typeof a?{x:t-o.scrollLeft(),y:a-o.scrollTop()}:"object"==typeof t&&t.pageX&&t.pageY?{clientX:t.pageX-o.scrollLeft(),clientY:t.pageY-o.scrollTop()}:void 0}function l(t,a,r){var o;if(!(o=n(a)?a:r||document).elementFromPoint)return null;var i,s,u=t,p=a;("object"==typeof t&&(t.clientX||t.clientY)&&(u=t.clientX||0,p=t.clientY||0),l.prototype.check)&&((i=e(o).scrollTop())>0?(null!==(s=o.elementFromPoint(0,i+e(window).height()-1))&&"HTML"===s.tagName.toUpperCase()&&(s=null),l.prototype.nativeUsesRelative=null===s):(i=e(o).scrollLeft())>0&&(null!==(s=o.elementFromPoint(i+e(window).width()-1,0))&&"HTML"===s.tagName.toUpperCase()&&(s=null),l.prototype.nativeUsesRelative=null===s),l.prototype.check=i<=0);return l.prototype.nativeUsesRelative||(u+=e(o).scrollLeft(),p+=e(o).scrollTop()),o.elementFromPoint(u,p)}function u(t,a){var r=a||{};e(t).trigger({type:"simulate-drag"}),e.isFunction(r.callback)&&r.callback.apply(t)}l.prototype.check=!0,l.prototype.nativeUsesRelative=!0,e.simulate.activeDrag=function(){return e.simulate._activeDrag?e.extend(!0,{},e.simulate._activeDrag):t},e.extend(e.simulate.prototype,{simulateDrag:function(){var r,p=this,c=p.target,d=e.extend({dx:0,dy:0,dragTarget:t,clickToDrag:!1,eventProps:{},interpolation:{stepWidth:0,stepCount:0,stepDelay:0,duration:0,shaky:!1},callback:t},this.options),g=e.simulate._activeDrag&&e.simulate._activeDrag.dragElement===c;r=g?e.simulate._activeDrag.dragStart:i(c);var m,v,h=Math.round(r.x),y=Math.round(r.y),f={pageX:h,pageY:y};if(d.dragTarget){var D=i(d.dragTarget);m=Math.round(D.x-r.x),v=Math.round(D.y-r.y)}else m=d.dx||0,v=d.dy||0;if(g?(e.simulate._activeDrag.dragDistance.x+=m,e.simulate._activeDrag.dragDistance.y+=v,f={pageX:Math.round(h+e.simulate._activeDrag.dragDistance.x),pageY:Math.round(y+e.simulate._activeDrag.dragDistance.y)}):(e.simulate._activeDrag&&e(e.simulate._activeDrag.dragElement).simulate("drop"),e.extend(d.eventProps,f),p.simulateEvent(c,"mousedown",d.eventProps),!0===d.clickToDrag&&(p.simulateEvent(c,"mouseup",d.eventProps),p.simulateEvent(c,"click",d.eventProps)),e(c).add(c.ownerDocument).one("mouseup",(function(){e.simulate._activeDrag=t})),e.extend(e.simulate,{_activeDrag:{dragElement:c,dragStart:{x:h,y:y},dragDistance:{x:m,y:v}}}),f={pageX:Math.round(h+m),pageY:Math.round(y+v)}),0!==m||0!==v)if(d.interpolation&&(d.interpolation.stepCount||d.interpolation.stepWidth))!function(t,r,i,p,c){var d,g,m,v=o([r,r.ownerDocument],n)||document,h=c.interpolation,y=Math.sqrt(Math.pow(p.dx,2)+Math.pow(p.dy,2));if(h.stepWidth){d=parseInt(h.stepWidth,10),g=Math.floor(y/d)-1;var f=d/y;m={x:p.dx*f,y:p.dy*f}}else d=y/((g=parseInt(h.stepCount,10))+1),m={x:p.dx/(g+1),y:p.dy/(g+1)};var D,x=e.extend({},i);function M(){x.x+=m.x,x.y+=m.y;var e={pageX:x.x,pageY:x.y};if(h.shaky&&(!0===h.shaky||!isNaN(parseInt(h.shaky,10)))){var a=!0===h.shaky?1:parseInt(h.shaky,10);e.pageX+=Math.floor(Math.random()*(2*a+1)-a),e.pageY+=Math.floor(Math.random()*(2*a+1)-a)}var n=l(s(e,v),v)||r;t.simulateEvent(n,"mousemove",{pageX:Math.round(e.pageX),pageY:Math.round(e.pageY)})}if(!h.stepDelay&&!h.duration||h.stepDelay<=0&&h.duration<=0){for(var T=0;T<g;T+=1)M();var k={pageX:Math.round(i.x+p.dx),pageY:Math.round(i.y+p.dy)},w=l(s(k,v),v)||r;t.simulateEvent(w,"mousemove",k),u(r,c)}else{var E=parseInt(h.stepDelay,10)||Math.ceil(parseInt(h.duration,10)/(g+1)),P=0;D=a(),setTimeout((function e(){var n=a()-D;if(n>=E)if(P<g)M(),P+=1,D=a(),setTimeout(e,E);else{var o={pageX:Math.round(i.x+p.dx),pageY:Math.round(i.y+p.dy)},d=l(s(o,v),v)||r;t.simulateEvent(d,"mousemove",o),u(r,c)}else setTimeout(e,E-n)}),E)}}(p,c,{x:h,y:y},{dx:m,dy:v},d);else{var x=o([c,c.ownerDocument],n)||document,M=l(s(f,x),x)||c;e.extend(d.eventProps,f),p.simulateEvent(M,"mousemove",d.eventProps),u(c,d)}else u(c,d)},simulateDrop:function(){var a=this,r=this.target,u=e.simulate._activeDrag,p=e.extend({clickToDrop:!1,eventProps:{},callback:t},a.options),c=!0,d=i(r),g=Math.round(d.x),m=Math.round(d.y),v={pageX:g,pageY:m},h=o(u?[u.dragElement,u.dragElement.ownerDocument]:[r,r.ownerDocument],n)||document,y=s(v,h),f=l(y,h);u&&(u.dragElement===r||n(r))&&(f=l(y=s(v={pageX:g=Math.round(u.dragStart.x+u.dragDistance.x),pageY:m=Math.round(u.dragStart.y+u.dragDistance.y)},h),h),c=!1),f||(f=u?u.dragElement:r),e.extend(p.eventProps,v),!0===c&&a.simulateEvent(f,"mousemove",p.eventProps),p.clickToDrop&&a.simulateEvent(f,"mousedown",p.eventProps),this.simulateEvent(f,"mouseup",p.eventProps),p.clickToDrop&&a.simulateEvent(f,"click",p.eventProps),e.simulate._activeDrag=t,e(f).trigger({type:"simulate-drop"}),e.isFunction(p.callback)&&p.callback.apply(f)},simulateDragNDrop:function(){var a=this.target,r=e.extend({dragTarget:t,dropTarget:t},this.options),n=(r.dragTarget||r.dx||r.dy?r.dropTarget:a)||a;e(a).simulate("drag",e.extend({},r,{dragTarget:r.dragTarget||(r.dx||r.dy?t:r.dropTarget),callback:function(){e(n).simulate("drop",r)}}))}})}(jQuery);