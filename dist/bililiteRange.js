!function(){function t(){}function e(){}function n(t,e){var n=e.text.replace(/\r/g,"").length;if(t.compareEndPoints("StartToStart",e)<=0)return 0;if(t.compareEndPoints("StartToEnd",e)>=0)return n;for(var i=0;t.compareEndPoints("StartToStart",e)>0;++i,t.moveStart("character",-1));return i}function i(t,e){var n=e.text.replace(/\r/g,"").length;if(t.compareEndPoints("EndToEnd",e)>=0)return n;if(t.compareEndPoints("EndToStart",e)<=0)return 0;for(var i=0;t.compareEndPoints("EndToStart",e)>0;++i,t.moveEnd("character",-1));return i}function o(){}function r(){}function s(t,e){if(t.firstChild)return t.firstChild;if(t.nextSibling)return t.nextSibling;if(t===e)return null;for(;t.parentNode;){if((t=t.parentNode)==e)return null;if(t.nextSibling)return t.nextSibling}return null}function a(t,e,n,i){if(!(e<=0)){var o=t[n?"startContainer":"endContainer"];for(3==o.nodeType&&(e+=t[n?"startOffset":"endOffset"]);o;){if(3==o.nodeType){if(e<=o.nodeValue.length){if(t[n?"setStart":"setEnd"](o,e),e==o.nodeValue.length){for(var r=s(o,i);r&&3==r.nodeType&&0==r.nodeValue.length;r=s(r,i))t[n?"setStartAfter":"setEndAfter"](r);r&&1==r.nodeType&&"BR"==r.nodeName&&t[n?"setStartAfter":"setEndAfter"](r)}return}t[n?"setStartAfter":"setEndAfter"](o),e-=o.nodeValue.length}o=s(o,i)}}}bililiteRange=function(t,n){var i;return(i=n?new g:document.selection?new e:window.getSelection&&t.setSelectionRange?new o:window.getSelection?new r:new g)._el=t,i._textProp=function(t){return void 0!==t.value?"value":void 0!==t.text?"text":void 0!==t.textContent?"textContent":"innerText"}(t),i._bounds=[0,i.length()],i},t.prototype={length:function(){return this._el[this._textProp].replace(/\r/g,"").length},bounds:function(t){if("all"===t)this._bounds=[0,this.length()];else if("start"===t)this._bounds=[0,0];else if("end"===t)this._bounds=[this.length(),this.length()];else if("selection"===t)this.bounds("all"),this._bounds=this._nativeSelection();else{if(!t)return[Math.max(0,Math.min(this.length(),this._bounds[0])),Math.max(0,Math.min(this.length(),this._bounds[1]))];this._bounds=t}return this},select:function(){return this._nativeSelect(this._nativeRange(this.bounds())),this},text:function(t,e){return arguments.length?(this._nativeSetText(t,this._nativeRange(this.bounds())),"start"==e?(this.bounds([this._bounds[0],this._bounds[0]]),this.select()):"end"==e?(this.bounds([this._bounds[0]+t.length,this._bounds[0]+t.length]),this.select()):"all"==e&&(this.bounds([this._bounds[0],this._bounds[0]+t.length]),this.select()),this):this._nativeGetText(this._nativeRange(this.bounds()))},insertEOL:function(){return this._nativeEOL(),this._bounds=[this._bounds[0]+1,this._bounds[0]+1],this}},e.prototype=new t,e.prototype._nativeRange=function(t){var e;return"INPUT"==this._el.tagName?e=this._el.createTextRange():(e=document.body.createTextRange()).moveToElementText(this._el),t&&(t[1]<0&&(t[1]=0),t[0]>this.length()&&(t[0]=this.length()),t[1]<e.text.replace(/\r/g,"").length&&(e.moveEnd("character",-1),e.moveEnd("character",t[1]-e.text.replace(/\r/g,"").length)),t[0]>0&&e.moveStart("character",t[0])),e},e.prototype._nativeSelect=function(t){t.select()},e.prototype._nativeSelection=function(){var t=this._nativeRange(),e=this.length();if("Text"!=document.selection.type)return[e,e];var o=document.selection.createRange();try{return[n(o,t),i(o,t)]}catch(r){return o.parentElement().sourceIndex<this._el.sourceIndex?[0,0]:[e,e]}},e.prototype._nativeGetText=function(t){return t.text.replace(/\r/g,"")},e.prototype._nativeSetText=function(t,e){e.text=t},e.prototype._nativeEOL=function(){void 0!==this._el.value?this.text("\n"):this._nativeRange(this.bounds()).pasteHTML("<br/>")},o.prototype=new t,o.prototype._nativeRange=function(t){return t||[0,this.length()]},o.prototype._nativeSelect=function(t){this._el.setSelectionRange(t[0],t[1])},o.prototype._nativeSelection=function(){return[this._el.selectionStart,this._el.selectionEnd]},o.prototype._nativeGetText=function(t){return this._el.value.substring(t[0],t[1])},o.prototype._nativeSetText=function(t,e){var n=this._el.value;this._el.value=n.substring(0,e[0])+t+n.substring(e[1])},o.prototype._nativeEOL=function(){this.text("\n")},r.prototype=new t,r.prototype._nativeRange=function(t){var e=document.createRange();return e.selectNodeContents(this._el),t&&(a(e,t[0],!0,this._el),e.collapse(!0),a(e,t[1]-t[0],!1,this._el)),e},r.prototype._nativeSelect=function(t){window.getSelection().removeAllRanges(),window.getSelection().addRange(t)},r.prototype._nativeSelection=function(){var t=this._nativeRange();if(0==window.getSelection().rangeCount)return[this.length(),this.length()];var e=window.getSelection().getRangeAt(0);return[d(e,t),p(e,t)]},r.prototype._nativeGetText=function(t){return t.toString()},r.prototype._nativeSetText=function(t,e){e.deleteContents(),e.insertNode(document.createTextNode(t)),this._el.normalize()},r.prototype._nativeEOL=function(){var t=this._nativeRange(this.bounds());t.deleteContents();var e=document.createElement("br");e.setAttribute("_moz_dirty",""),t.insertNode(e),t.insertNode(document.createTextNode("\n")),t.collapse(!1)};var u=0,l=1,h=2,c=3;function d(t,e){return t.compareBoundaryPoints(u,e)<=0?0:t.compareBoundaryPoints(c,e)>=0?e.toString().length:((t=t.cloneRange()).setEnd(e.endContainer,e.endOffset),e.toString().length-t.toString().length)}function p(t,e){return t.compareBoundaryPoints(h,e)>=0?e.toString().length:t.compareBoundaryPoints(l,e)<=0?0:((t=t.cloneRange()).setStart(e.startContainer,e.startOffset),t.toString().length)}function g(){}g.prototype=new t,g.prototype._nativeRange=function(t){return t||[0,this.length()]},g.prototype._nativeSelect=function(t){},g.prototype._nativeSelection=function(){return[0,0]},g.prototype._nativeGetText=function(t){return this._el[this._textProp].substring(t[0],t[1])},g.prototype._nativeSetText=function(t,e){var n=this._el[this._textProp];this._el[this._textProp]=n.substring(0,e[0])+t+n.substring(e[1])},g.prototype._nativeEOL=function(){this.text("\n")}}();