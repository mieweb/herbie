!function(e,t){"use strict";e.simulate.prototype.quirks=e.simulate.prototype.quirks||{},e.extend(e.simulate.prototype.quirks,{delayedSpacesInNonInputGlitchToEnd:t}),e.extend(e.simulate.prototype,{simulateKeySequence:function(){var n=this.target,s=e(n),a=e.extend({sequence:"",triggerKeyEvents:!0,eventProps:{},delay:0,callback:t},this.options),o=a.sequence;a.delay=parseInt(a.delay,10);var u={};e.simulate.prototype.quirks.delayedSpacesInNonInputGlitchToEnd&&!s.is("input,textarea")&&e.extend(u,{" ":function(n,s,a){var o=e.extend({},a,{triggerKeyEvents:!1,delay:0,callback:t});e.simulate.prototype.simulateKeySequence.defaults.simplechar(n,"\xa0",o),e.simulate.prototype.simulateKeySequence.defaults["{leftarrow}"](n,s,o),e.simulate.prototype.simulateKeySequence.defaults.simplechar(n,s,a),e.simulate.prototype.simulateKeySequence.defaults["{del}"](n,s,o)}}),e.extend(u,a,s.data("simulate-keySequence"));var l=e.data(n,"simulate-keySequence.selection");if(l||(l=bililiteRange(n).bounds("selection"),e.data(n,"simulate-keySequence.selection",l),s.bind("mouseup.simulate-keySequence",(function(){e.data(n,"simulate-keySequence.selection").bounds("selection")})).bind("keyup.simulate-keySequence",(function(t){9===t.which?e.data(n,"simulate-keySequence.selection").select():e.data(n,"simulate-keySequence.selection").bounds("selection")}))),s.focus(),void 0!==o)if(o=o.replace(/\n/g,"{enter}"),!a.delay||a.delay<=0)o.replace(/\{[^}]*\}|[^{]+/g,(function(t){(u[t]||e.simulate.prototype.simulateKeySequence.defaults[t]||e.simulate.prototype.simulateKeySequence.defaults.simplechar)(l,t,a)})),c();else{var i=/\{[^}]*\}|[^{]/g,r=Date.now||function(){return(new Date).getTime()},d=r();!function t(){var n=r()-d;if(n>=a.delay){var s=i.exec(o);if(null!==s){var y=s[0];(u[y]||e.simulate.prototype.simulateKeySequence.defaults[y]||e.simulate.prototype.simulateKeySequence.defaults.simplechar)(l,y,a),setTimeout(t,a.delay)}else c();d=r()}else setTimeout(t,a.delay-n)}()}function c(){s.trigger({type:"simulate-keySequence",sequence:o}),e.isFunction(a.callback)&&a.callback.apply(n,[{sequence:o}])}}}),e.extend(e.simulate.prototype.simulateKeySequence.prototype,{IEKeyCodeTable:{33:49,64:50,35:51,36:52,37:53,94:54,38:55,42:56,40:57,41:48,59:186,58:186,61:187,43:187,44:188,60:188,45:189,95:189,46:190,62:190,47:191,63:191,96:192,126:192,91:219,123:219,92:220,124:220,93:221,125:221,39:222,34:222},charToKeyCode:function(n){var s=e.simulate.prototype.simulateKeySequence.prototype.IEKeyCodeTable,a=n.charCodeAt(0);return a>=64&&a<=90||a>=48&&a<=57?a:a>=97&&a<=122?n.toUpperCase().charCodeAt(0):s[a]!==t?s[a]:a}}),e.simulate.prototype.simulateKeySequence.defaults={simplechar:function(t,n,s){if(t.text(n,"end"),s.triggerKeyEvents)for(var a=0;a<n.length;a+=1){var o=n.charCodeAt(a),u=e.simulate.prototype.simulateKeySequence.prototype.charToKeyCode(n.charAt(a));e(t._el).simulate("keydown",e.extend({},s.eventProps,{keyCode:u})),e(t._el).simulate("keypress",e.extend({},s.eventProps,{keyCode:o,which:o,charCode:o})),e(t._el).simulate("keyup",e.extend({},s.eventProps,{keyCode:u}))}},"{{}":function(t,n,s){e.simulate.prototype.simulateKeySequence.defaults.simplechar(t,"{",s)},"{enter}":function(t,n,s){t.insertEOL(),t.select(),!0===s.triggerKeyEvents&&(e(t._el).simulate("keydown",e.extend({},s.eventProps,{keyCode:13})),e(t._el).simulate("keypress",e.extend({},s.eventProps,{keyCode:13,which:13,charCode:13})),e(t._el).simulate("keyup",e.extend({},s.eventProps,{keyCode:13})))},"{backspace}":function(t,n,s){var a=t.bounds();a[0]===a[1]&&t.bounds([a[0]-1,a[0]]),t.text("","end"),!0===s.triggerKeyEvents&&(e(t._el).simulate("keydown",e.extend({},s.eventProps,{keyCode:8})),e(t._el).simulate("keyup",e.extend({},s.eventProps,{keyCode:8})))},"{del}":function(t,n,s){var a=t.bounds();a[0]===a[1]&&t.bounds([a[0],a[0]+1]),t.text("","end"),!0===s.triggerKeyEvents&&(e(t._el).simulate("keydown",e.extend({},s.eventProps,{keyCode:46})),e(t._el).simulate("keyup",e.extend({},s.eventProps,{keyCode:46})))},"{rightarrow}":function(t,n,s){var a=t.bounds();a[0]===a[1]&&(a[1]+=1),t.bounds([a[1],a[1]]).select(),!0===s.triggerKeyEvents&&(e(t._el).simulate("keydown",e.extend({},s.eventProps,{keyCode:39})),e(t._el).simulate("keyup",e.extend({},s.eventProps,{keyCode:39})))},"{leftarrow}":function(t,n,s){var a=t.bounds();a[0]===a[1]&&(a[0]-=1),t.bounds([a[0],a[0]]).select(),!0===s.triggerKeyEvents&&(e(t._el).simulate("keydown",e.extend({},s.eventProps,{keyCode:37})),e(t._el).simulate("keyup",e.extend({},s.eventProps,{keyCode:37})))},"{selectall}":function(e){e.bounds("all").select()}},!0!==e.simulate.ext_disableQuirkDetection&&e(document).ready((function(){var t=e("<div/>").css({height:1,width:1,position:"absolute",left:-1e3,top:-1e3}).appendTo("body");t.simulate("key-sequence",{sequence:"\xa0 \xa0",delay:1,callback:function(){e.simulate.prototype.quirks.delayedSpacesInNonInputGlitchToEnd="\xa0\xa0 "===t.text(),t.remove()}})}))}(jQuery);